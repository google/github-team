rules:
  - id: pull-request-target-needs-exception
    languages:
      - yaml
    severity: ERROR
    message: 'pull_request_target is a high-risk event and should only be used in exceptional cases.  
Please choose a safer trigger whenever possible.  
If you are certain this workflow requires pull_request_target, you may dismiss this alert and proceed with the merge.  
For more details, see: https://google.github.io/github-team/semgrep-rules/pull-request-target-needs-exception.html'
    metadata:
      category: best-practice
      technology:
        - github-actions
    patterns:
      - pattern-either:
          - patterns:
              - pattern-inside: "{on: ...}"
              - pattern: pull_request_target
